---
title: "Particle Swarm Optimizer"
author: "Jack Thomas"
date: "April 11, 2019"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Trying out 2D first

```{r algorithm 2d}
set.seed(123)
#Simple function
f <- function(x){
  return(x^2)
}

curve(f(x),-5,5)

swarm <- function(S,lower, upper,omega,phiP,phiG){
  iterations <- 100
  best_swarm <- lower
  #particle positions
  x <- rep(0,S)
  #particle best positions
  p <- rep(0,S)
  #particle velocities
  v <- rep(0,S)
  
  #for each particle i 
  for (i in 1:S){
    #initial position
    x[i] <- runif(1,lower,upper)
    p[i] <- x[i]
    
    if(f(p[i]) < f(best_swarm)){
      best_swarm <- p[i]
    }
    
    #initial velocity
    v[i] <- runif(1,-abs(upper-lower),abs(upper-lower))
  }
  #print(x)
  #print(p)
  #print(v)
  #print(best_swarm)
  for(j in 1:iterations){
    
    for (i in 1:S){
      rp <- runif(1,0,1)
      rg <- runif(1,0,1)
      
      v[i] <- omega*v[i] + phiP*rp*(p[i]-x[i]) + phiG*rg*(best_swarm-x[i])
      
      x[i] <- x[i] + v[i]
      
      if (f(x[i]) < f(p[i])){
        p[i] <- x[i]
        
        #update best position in the swarm
        if (f(p[i]) < f(best_swarm)){
          best_swarm <- p[i]
        }
      }
    }
    if((j%%2 == 0 && j < 20) || j == 1){
      curve(f,lower,upper,main = c("iteration ",j))
      points(x,f(x))
    }
    
  }
  cat("best x value: ",best_swarm,"\n")
  cat("minimum: ",f(best_swarm),"\n")
  cat("\n")
}

swarm(10,-4,4,.5,.5,.5)

#more complex function
f <- function(x){
  return(x^3 - 9*x)
}
curve(f,-2,4)

swarm(10,-2,4,.5,.5,.5)

```



```{r nd algorithm}

## have to implement lower and upper handling (they are vectors)
## initializing positions given lower vector and upper vector (for loop?)

swarm <- function(S,n,lower, upper,omega,phiP,phiG){
  iterations <- 100
  best_swarm <- lower
  #particle positions
  x <- matrix(0,nrow = n,ncol = S) 
  #particle best positions
  p <- matrix(0,nrow = n,ncol = S) 
  #particle velocities
  v <- matrix(0,nrow = n,ncol = S) 
  
  #for each particle i 
  for (i in 1:S){
    #initial position
    x[,i] <- runif(n,lower,upper)
    p[,i] <- x[,i]
    
    if(f(p[,i]) < f(best_swarm)){
      best_swarm <- p[,i]
    }
    
    #initial velocity
    v[,i] <- runif(n,-abs(upper-lower),abs(upper-lower))
  }
  #print(x)
  #print(p)
  #print(v)
  #print(best_swarm)
  for(j in 1:iterations){
    
    for (i in 1:S){
      
      for (d in 1:n){
        rp <- runif(1,0,1)
        rg <- runif(1,0,1)
      
        v[,i] <- omega*v[,i] + phiP*rp*(p[,i]-x[,i]) + phiG*rg*(best_swarm-x[,i])
        
      }
      
      
      x[,i] <- x[,i] + v[,i]
      
      if (f(x[,i]) < f(p[,i])){
        p[,i] <- x[,i]
        
        #update best position in the swarm
        if (f(p[,i]) < f(best_swarm)){
          best_swarm <- p[,i]
        }
      }
    }
    if((j%%2 == 0 && j < 20) || j == 1){
      curve(f,lower,upper,main = c("iteration ",j))
      points(x,f(x))
    }
    
  }
  cat("best x value: ",best_swarm,"\n")
  cat("minimum: ",f(best_swarm),"\n")
  cat("\n")
}


f <- function(x,y){
  return(x^2 )
}
```









